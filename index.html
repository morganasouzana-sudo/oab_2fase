<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>OAB Zen - Estudo de Alto Nível</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #2C3E50;
            --accent: #E67E22;  /* Laranja OAB */
            --success: #27AE60;
            --danger: #C0392B;
            --bg: #F3F4F6;
            --card: #FFFFFF;
            --text: #1F2937;
            --text-light: #6B7280;
        }

        * { box-sizing: border-box; font-family: 'Segoe UI', Roboto, Helvetica, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; padding: 0; 
            background: var(--bg); color: var(--text); 
            height: 100vh; display: flex; flex-direction: column;
            overflow: hidden; /* Trava rolagem externa */
        }

        /* HEADER */
        header {
            background: var(--card);
            padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            z-index: 10; flex-shrink: 0;
        }

        h1 { margin: 0; font-size: 1.2rem; color: var(--primary); font-weight: 800; }
        .subtitle { font-size: 0.8rem; color: var(--text-light); font-weight: 400; }

        .btn-zen {
            background: #E0F2F1; color: #00695C;
            border: none; padding: 8px 16px; border-radius: 20px;
            font-size: 0.85rem; font-weight: 600; cursor: pointer;
            display: flex; align-items: center; gap: 6px;
        }

        /* MAIN AREA */
        main {
            flex: 1; padding: 20px;
            padding-bottom: 90px; /* Espaço para a barra inferior */
            overflow-y: auto; /* Rolagem interna apenas se necessário */
            max-width: 700px; margin: 0 auto; width: 100%;
            display: flex; flex-direction: column;
        }

        .hidden { display: none !important; }

        /* SELEÇÃO */
        .card-menu {
            background: var(--card);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-top: 20px;
        }

        select {
            width: 100%; padding: 15px;
            border: 2px solid #E5E7EB; border-radius: 12px;
            margin-top: 20px; font-size: 1rem;
            background: #F9FAFB; outline: none;
        }

        /* WIZARD & CASE CONTEXT */
        .case-context {
            background: #FFF7ED;
            border-left: 5px solid var(--accent);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            line-height: 1.5;
            color: #7C2D12;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .step-card {
            background: var(--card);
            border-radius: 20px;
            padding: 0;
            box-shadow: 0 10px 15px rgba(0,0,0,0.05);
            overflow: hidden;
            display: flex; flex-direction: column;
            flex: 1; /* Ocupa espaço disponível */
        }

        .step-header {
            background: var(--primary);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .step-content {
            padding: 20px;
            flex: 1;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .answer-box {
            background: #F0FDF4;
            border: 1px solid #BBF7D0;
            color: #166534;
            padding: 15px;
            border-radius: 12px;
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 20px;
            width: 100%;
            text-align: left;
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .answer-box strong { color: #14532D; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* BUTTONS */
        .btn-reveal {
            background: var(--accent); color: white;
            border: none; padding: 15px 30px; border-radius: 12px;
            font-size: 1rem; font-weight: 700; cursor: pointer;
            width: 100%;
            box-shadow: 0 4px 6px rgba(230, 126, 34, 0.3);
            transition: transform 0.1s;
        }
        .btn-reveal:active { transform: scale(0.98); }

        .rating-area {
            display: flex; gap: 10px; width: 100%;
            display: none;
        }
        
        .btn-rate {
            flex: 1; padding: 15px; border-radius: 12px;
            border: none; font-weight: 700; color: white; cursor: pointer;
            font-size: 0.9rem; display: flex; flex-direction: column; align-items: center; gap: 5px;
        }
        .rate-bad { background: #EF4444; }
        .rate-good { background: #10B981; }

        /* FLASHCARDS */
        .flashcard-container { 
            margin-top: 10px; 
            perspective: 1000px; 
            flex: 1; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            transition: opacity 0.3s ease; /* Animação de fade */
        }
        
        .flashcard-inner {
            position: relative; 
            width: 100%; 
            height: 100%; 
            min-height: 300px; /* Reduzido para caber melhor */
            max-height: 500px;
            text-align: center; 
            transition: transform 0.6s; 
            transform-style: preserve-3d;
            cursor: pointer;
            background: white; 
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.08);
        }
        
        /* Classe de virada */
        .flashcard-inner.flipped { transform: rotateY(180deg); }
        
        .fc-front, .fc-back {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            border-radius: 20px; padding: 30px;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .fc-front { border-bottom: 6px solid var(--accent); }
        .fc-back { background: var(--primary); color: white; transform: rotateY(180deg); border-bottom: 6px solid var(--success); overflow-y: auto; }

        /* NAV */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%; background: var(--card);
            display: flex; justify-content: space-around; padding: 12px 0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.05); z-index: 20;
        }
        .nav-item {
            background: none; border: none; cursor: pointer;
            color: var(--text-light); font-size: 0.75rem;
            display: flex; flex-direction: column; align-items: center; gap: 4px;
        }
        .nav-item.active { color: var(--accent); font-weight: 700; }
        .nav-item i { font-size: 1.4rem; }

    </style>
</head>
<body>

    <header>
        <div>
            <h1>OAB Penal</h1>
            <span class="subtitle">Prática Guiada</span>
        </div>
        <button class="btn-zen" onclick="alert('Respire fundo por 4 segundos...\nSegure por 4 segundos...\nSolte por 4 segundos.')">
            <i class="fas fa-leaf"></i> Zen
        </button>
    </header>

    <main id="main-content">
        
        <!-- 1. SELEÇÃO -->
        <div id="selection-screen" class="card-menu">
            <i class="fas fa-gavel" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
            <h2>Escolha o Exame</h2>
            <p style="color: var(--text-light); margin-bottom: 20px;">Vamos simular a estrutura da peça passo a passo.</p>
            <select id="piece-selector" onchange="startCase()">
                <option value="">Selecione...</option>
            </select>
        </div>

        <!-- 2. WIZARD (PEÇA) -->
        <div id="wizard-screen" class="hidden" style="flex: 1; display: flex; flex-direction: column;">
            
            <!-- Resumo do Caso (Contexto) -->
            <div id="case-context-box" class="case-context hidden">
                <strong><i class="fas fa-file-alt"></i> O CASO:</strong><br>
                <span id="case-text">...</span>
                <button onclick="hideContext()" style="display:block; margin-top:10px; font-size:0.8rem; background:none; border:none; text-decoration:underline; color:var(--primary); cursor:pointer;">Esconder Resumo</button>
            </div>
            <button id="btn-show-context" class="hidden" onclick="showContext()" style="margin-bottom:10px; font-size:0.85rem; background:#E5E7EB; border:none; padding:8px; border-radius:8px; cursor:pointer;">
                <i class="fas fa-eye"></i> Ver Resumo do Caso
            </button>

            <!-- Cartão de Passo -->
            <div id="step-container" class="step-card">
                <!-- Injetado via JS -->
            </div>
        </div>

        <!-- 3. FLASHCARDS -->
        <div id="flashcard-screen" class="hidden" style="flex: 1; display: flex; flex-direction: column;">
            <!-- Adicionado ID aqui para o JS encontrar -->
            <div class="flashcard-container" id="flashcard-container">
                <div class="flashcard-inner" id="card-inner" onclick="flipCard()">
                    <div class="fc-front">
                        <span style="background:var(--accent); color:white; padding:4px 10px; border-radius:10px; font-size:0.7rem; margin-bottom:15px; font-weight:700;">TOQUE PARA VIRAR</span>
                        <p id="fc-q" style="font-size: 1.2rem; font-weight:700; line-height: 1.4;">Carregando...</p>
                    </div>
                    <div class="fc-back">
                        <p id="fc-a" style="font-size: 1.1rem; line-height:1.6;">Resposta...</p>
                    </div>
                </div>
            </div>
            <div style="display:flex; gap:10px; margin-top:15px; justify-content: center;">
                <button class="btn-reveal" style="background:var(--primary); width: auto; min-width: 200px;" onclick="nextCard()">Próxima Carta <i class="fas fa-arrow-right"></i></button>
            </div>
        </div>

    </main>

    <nav class="bottom-nav">
        <button class="nav-item active" onclick="switchTab('peca', this)">
            <i class="fas fa-file-signature"></i>
            <span>Peça</span>
        </button>
        <button class="nav-item" onclick="switchTab('questoes', this)">
            <i class="fas fa-brain"></i>
            <span>Questões</span>
        </button>
    </nav>

    <script>
        // --- DADOS (ENRIQUECIDOS) ---
        const OAB_DATA = {
            "44exame": {
                context: "Aluísio (entregador) destruiu peça de decoração de jacaré na casa de Manoel pensando ser um animal real (risco). Manoel ofereceu queixa-crime (Dano - Art. 163 CP). MP pediu condenação. Sentença condenou.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Apelação</strong> (Art. 82 da Lei 9.099/95).<br>Trata-se de crime de menor potencial ofensivo (JECRIM)." },
                    { label: "Endereçamento da Interposição", answer: "Ao <strong>Juizado Especial Criminal</strong> da Comarca... (Juiz a quo)." },
                    { label: "Endereçamento das Razões", answer: "À <strong>Turma Recursal</strong> (Juízo ad quem)." },
                    { label: "Preliminar: Extinção da Punibilidade", answer: "<strong>Perempção.</strong><br>O querelante (Manoel) deixou de pedir condenação nas alegações finais.<br>Art. 60, III CPP c/c Art. 107, IV CP." },
                    { label: "Mérito: Tese Principal", answer: "<strong>Atipicidade (Erro de Tipo Permissivo).</strong><br>Aluísio supôs situação de perigo (descriminante putativa).<br>Art. 20, §1º do CP." },
                    { label: "Subsidiária: Dosimetria", answer: "Afastar <strong>Reincidência</strong>.<br>Condenação anterior por crime militar próprio não gera reincidência.<br>Art. 64, II CP." },
                    { label: "Pedidos Finais", answer: "1. Conhecimento e Provimento;<br>2. Absolvição (Art. 386 CPP);<br>3. Subsidiariamente: Pena mínima e regime aberto." }
                ]
            },
            "43exame": {
                context: "Arthur denunciado por lesão corporal leve contra esposa Aline (Violência Doméstica). Chutou a esposa após jogo. MP pediu condenação e indenização. Juiz condenou. MP não recorreu. Aline (assistente) recorreu para aumentar pena.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Contrarrazões de Apelação</strong>.<br>Fundamento: Art. 600 do CPP.<br>Você defende Arthur contra o recurso da assistente." },
                    { label: "Prazo", answer: "<strong>3 dias</strong> (Rito da Lei 9.099/95 aplicado subsidiariamente ou prazo de contrarrazões em geral)." },
                    { label: "Preliminar 1: Ação Penal", answer: "<strong>Ação Pública Incondicionada</strong>.<br>Não se aplica Lei 9.099 na Maria da Penha (Súmula 542 STJ). Aline não poderia 'desistir'." },
                    { label: "Preliminar 2: Nulidade", answer: "<strong>Inexistência de Cerceamento.</strong><br>Perguntas sobre vida sexual da vítima são proibidas (Art. 400-A CPP)." },
                    { label: "Mérito", answer: "Manutenção da sentença quanto à imputabilidade.<br>Embriaguez voluntária não exclui culpa (Art. 28, II CP)." },
                    { label: "Pedidos", answer: "<strong>Desprovimento</strong> do recurso da acusação." }
                ]
            },
            "42exame": {
                context: "Diogo denunciado por Lavagem de Dinheiro (ocultar R$ 100 mil). Polícia entrou na casa sem mandado (apenas denúncia anônima) e achou o dinheiro. Não achou drogas. Diogo é reincidente.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Resposta à Acusação</strong>.<br>Art. 396 / 396-A do CPP.<br>Momento logo após a citação." },
                    { label: "Preliminar de Nulidade", answer: "<strong>Ilicitude da Prova (Busca Domiciliar).</strong><br>Denúncia anônima sem diligência prévia não autoriza ingresso sem mandado.<br>Violação ao Art. 5º, XI, CF. Teoria dos Frutos da Árvore Envenenada." },
                    { label: "Preliminar de Inépcia", answer: "<strong>Inépcia da Denúncia.</strong><br>MP não descreveu o crime antecedente necessário para lavagem de dinheiro.<br>Art. 41 CPP." },
                    { label: "Mérito", answer: "<strong>Absolvição Sumária (Atipicidade).</strong><br>Ter dinheiro em casa não é crime se não provada a origem ilícita.<br>Art. 397, III CPP." }
                ]
            },
            "41exame": {
                context: "Abelardo, Lineu e Mendonça denunciados (Corrupção). Lineu delatou. Juiz deu prazo comum para alegações finais (delator e delatados). Sentença proferida por juiz substituto que não fez a instrução.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Apelação</strong> (Art. 593, I, CPP)." },
                    { label: "Nulidade 1: Prazos", answer: "<strong>Cerceamento de Defesa.</strong><br>Delatado deve falar DEPOIS do delator (prazo sucessivo, não comum).<br>Súmula Vinculante ou Jurisprudência STF." },
                    { label: "Nulidade 2: Juiz", answer: "<strong>Violação à Identidade Física do Juiz.</strong><br>Art. 399, §2º CPP. Quem colheu a prova deve julgar, salvo exceções legais." },
                    { label: "Mérito", answer: "<strong>Absolvição (Falta de Provas).</strong><br>Palavra do colaborador isolada não basta para condenar.<br>Art. 4º, §16, Lei 12.850/13." }
                ]
            },
            "40exame": {
                context: "Gustavo (entregador) praticou furto de uso de bicicletas por 7 dias (pegava e devolvia intacta). No 8º dia, porta estava aberta (entrou sem escalar) e bicicleta foi destruída por acidente. MP denunciou por Furto Qualificado.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Apelação</strong> (Art. 593, I, CPP)." },
                    { label: "Mérito (Fatos 1 a 7)", answer: "<strong>Atipicidade (Furto de Uso).</strong><br>Havia intenção de devolver e a coisa foi restituída intacta. Não há ânimo de assenhoreamento." },
                    { label: "Mérito (Fato 8)", answer: "<strong>Desclassificação para Furto Simples.</strong><br>Porta aberta não configura qualificado pela escalada (Art. 155, §4º CP)." },
                    { label: "Causa de Diminuição", answer: "<strong>Arrependimento Posterior.</strong><br>Se houve reparação do dano antes da denúncia (nos casos aplicáveis) ou tese subsidiária de crime continuado." }
                ]
            },
            "39exame": {
                context: "Luíza e Alfredo (casados) em cruzeiro. Alfredo agrediu Luíza em águas internacionais/deslocamento. Aportaram em Flores (CB). MP Estadual denunciou na Vara de Violência Doméstica. Juiz Estadual aceitou.",
                steps: [
                    { label: "Qual a Peça Cabível?", answer: "<strong>Apelação</strong> (Art. 593, I, CPP)." },
                    { label: "Preliminar de Nulidade", answer: "<strong>Incompetência da Justiça Estadual.</strong><br>Crimes a bordo de navios em deslocamento internacional são de competência da Justiça Federal (Art. 109, IX, CF)." },
                    { label: "Subsidiária: Dosimetria", answer: "<strong>Pena-base no Mínimo.</strong><br>Afastar agravantes genéricas se constituem bis in idem com causas de aumento." },
                    { label: "Pedidos", answer: "Anulação do processo ab initio (Incompetência) ou redução da pena e regime aberto." }
                ]
            }
        };

        const QUESTIONS = [
            { q: "O falso (doc) se exauriu no estelionato. Qual a tese?", a: "<strong>Consunção</strong> (Súmula 17 STJ)." },
            { q: "Réu menor de 18 na ação, vítima morre depois. Imputável?", a: "Não. <strong>Teoria da Atividade</strong> (Art. 4º CP)." },
            { q: "Quebra de vidro p/ salvar bebê de insolação é crime?", a: "Não. <strong>Estado de Necessidade</strong>." },
            { q: "Busca domiciliar só com denúncia anônima é válida?", a: "Não. Prova <strong>Ilícita</strong>." },
            { q: "Palavra do delator sozinha condena?", a: "Não. Precisa de <strong>Corroboração</strong> (Lei 12.850)." },
            { q: "Embriaguez voluntária isenta de pena?", a: "Não. (Art. 28, II CP)." },
            { q: "Prazo da Apelação (Regra Geral)?", a: "5 dias (Interposição) + 8 dias (Razões)." },
            { q: "Prazo da Apelação (JECRIM)?", a: "10 dias (Interposição e Razões juntas)." }
        ];

        // --- LÓGICA ---
        let currentSteps = [];
        let stepIndex = 0;

        function init() {
            const sel = document.getElementById('piece-selector');
            Object.keys(OAB_DATA).sort().reverse().forEach(k => {
                let opt = document.createElement('option');
                opt.value = k;
                opt.text = k.replace("exame", "º Exame");
                sel.appendChild(opt);
            });
            loadNextFlashcard();
        }

        function switchTab(tab, btn) {
            document.querySelectorAll('.nav-item').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            if(tab === 'peca') {
                document.getElementById('selection-screen').classList.remove('hidden');
                document.getElementById('wizard-screen').classList.add('hidden');
                document.getElementById('flashcard-screen').classList.add('hidden');
                // Se já tinha peça rodando, volta pro wizard
                if(currentSteps.length > 0) document.getElementById('wizard-screen').classList.remove('hidden');
                if(currentSteps.length > 0) document.getElementById('selection-screen').classList.add('hidden');
            } else {
                document.getElementById('selection-screen').classList.add('hidden');
                document.getElementById('wizard-screen').classList.add('hidden');
                document.getElementById('flashcard-screen').classList.remove('hidden');
            }
        }

        function startCase() {
            const key = document.getElementById('piece-selector').value;
            if(!key) return;
            
            const data = OAB_DATA[key];
            currentSteps = data.steps;
            stepIndex = 0;
            
            document.getElementById('case-text').innerText = data.context;
            document.getElementById('case-context-box').classList.remove('hidden');
            document.getElementById('btn-show-context').classList.add('hidden');
            
            document.getElementById('selection-screen').classList.add('hidden');
            document.getElementById('wizard-screen').classList.remove('hidden');
            
            renderStep();
        }

        function renderStep() {
            const step = currentSteps[stepIndex];
            const total = currentSteps.length;
            const container = document.getElementById('step-container');
            
            container.innerHTML = `
                <div class="step-header">Passo ${stepIndex + 1} de ${total}</div>
                <div class="step-content">
                    <div class="question-text">${step.label}</div>
                    
                    <button id="btn-rev" class="btn-reveal" onclick="revealAnswer()">
                        Tocar para Revelar Gabarito
                    </button>

                    <div id="ans-box" class="answer-box">${step.answer}</div>

                    <div id="rating" class="rating-area">
                        <button class="btn-rate rate-bad" onclick="nextStep(false)">
                            <i class="fas fa-times"></i> Errei / Esqueci
                        </button>
                        <button class="btn-rate rate-good" onclick="nextStep(true)">
                            <i class="fas fa-check"></i> Acertei
                        </button>
                    </div>
                </div>
            `;
        }

        function revealAnswer() {
            document.getElementById('btn-rev').style.display = 'none';
            document.getElementById('ans-box').style.display = 'block';
            document.getElementById('rating').style.display = 'flex';
        }

        function nextStep(result) {
            if(stepIndex < currentSteps.length - 1) {
                stepIndex++;
                renderStep();
            } else {
                // Fim
                document.getElementById('step-container').innerHTML = `
                    <div class="step-content">
                        <i class="fas fa-trophy" style="font-size:3rem; color:var(--accent); margin-bottom:20px;"></i>
                        <h2>Peça Finalizada!</h2>
                        <p>Você revisou toda a estrutura.</p>
                        <button class="btn-reveal" onclick="location.reload()">Escolher Outra</button>
                    </div>
                `;
            }
        }

        function showContext() {
            document.getElementById('case-context-box').classList.remove('hidden');
            document.getElementById('btn-show-context').classList.add('hidden');
        }
        
        function hideContext() {
            document.getElementById('case-context-box').classList.add('hidden');
            document.getElementById('btn-show-context').classList.remove('hidden');
        }

        // FLASHCARDS
        let qIndex = 0;
        function loadNextFlashcard() {
            let next = Math.floor(Math.random() * QUESTIONS.length);
            let item = QUESTIONS[next];
            document.getElementById('fc-q').innerHTML = item.q;
            document.getElementById('fc-a').innerHTML = item.a;
            document.getElementById('card-inner').classList.remove('flipped');
        }

        function flipCard() {
            document.getElementById('card-inner').classList.toggle('flipped');
        }

        function nextCard() {
            const container = document.getElementById('flashcard-container');
            container.style.opacity = '0';
            setTimeout(() => {
                loadNextFlashcard();
                container.style.opacity = '1';
            }, 300);
        }

        window.onload = init;

    </script>
</body>
</html>
